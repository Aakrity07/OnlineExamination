<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RegisterExamination</title>
    <style>
        .error{
            color: red;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
</head>

<body>
    <div class="container text-center my-4">
        <img src="elgoss.jpg" alt="elgoss" style="width: 200px; height: 50px;">
    </div>

    <div class="container shadow-lg rounded col-5  mt-2 mb-5 py-2">

        <h3 class="text-center pt-2">Create a new Account</h3>
        <p class="text-center">Its Quick and easy</p>
        <hr>
        <div class="container">
            <div class="row my-2">
                <div class="col-6">
                    <input type="text" name="firstName" id="firstName" placeholder="first Name" class="form-control">
                </div>
                <div class="col-6 ">
                    <input type="text" name="lastName" id="lastName" placeholder="last Name" class="form-control">

                    </div>
                </div>
            </div>
            <div class="container">
                <span class="">Date of Birth?</span>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-4">
                        <select name="" id="dob-day" class="form-select">
                            <option value="" selected disabled>day</option>
                        </select>
                        <span class="error" id="dayerror"></span>

                    </div>
                    <div class="col-4">
                        <select name="" id="dob-month" class="form-select">
                            <option value="" selected disabled>Month</option>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <span class="error" id="montherror"></span>

                    </div>
                    <div class="col-4">
                        <select name="" id="dob-year" class="form-select">
                            <option value="" selected disabled>Year</option>
                        </select>
                        <span class="error" id="yearerror"></span>
                    </div>
                </div>
            </div>
            <div class="container pt-2">
                <span>Gender?</span>
            </div>
            <div class="row g-5 px-3 pb-2">
                <div class="col-12 col-md-4">
                    <div class="border rounded p-2 text-center">
                        <label class="form-check-label" for="male">Male</label>
                        <input class="form-check-input ms-2" type="radio" name="gender" id="male">
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="border rounded p-2 text-center">
                        <label class="form-check-label" for="female">Female</label>
                        <input class="form-check-input ms-2" type="radio" name="gender" id="female">
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="border rounded p-2 text-center">
                        <label class="form-check-label" for="custom">Custom</label>
                        <input class="form-check-input ms-2" type="radio" name="gender" id="custom">
                        <span class="error" id="gendererror"></span>

                    </div>
                </div>
            </div>

        <div class="container">
            <div class="row p-2">
                <div class="">
                    <input type="email" name="" id="" class="form-control" placeholder="Phone Number or email address">
                </div>

            </div>
            <div class="row p-2">
                <div class="">
                    <input type="password" name="" id="" class="form-control" placeholder=" New password">
                </div>
            </div>
            <p class="small text-secondary ">Welcome to the Online Examination Portal! Register now to take your first
                step towards academic success.
                Our platform offers a smooth, secure, and user-friendly exam experience from the comfort of your home.
            </p>
            <p class="small text-secondary">Don‚Äôt miss the opportunity to test your knowledge, improve your performance,
                and achieve your goals. Join today and stay ahead in your learning journey!</p>
        </div>
        <div class="container d-flex justify-content-center">

            <button class="btn btn-primary px-5 text-center align-item-center" type="submit" id="registerBtn">Sign
                Up</button>
        </div>
        <div class="container p-2 text-center">
            <a href="login.html" class="">Already have an Account? </a>
        </div>
    </div>
    <script>
        document.querySelector("button.btn-primary").addEventListener("click", () => {
  const firstName = document.getElementById("firstName").value;
  const lastName = document.getElementById("lastName").value;
  const email = document.querySelector("input[type='email']").value;
  const password = document.querySelector("input[type='password']").value;

  fetch("/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ firstName, lastName, email, password })
  })
    .then(res => res.text())
    .then(msg => {
      alert(msg);
      if (msg === "Registration successful") {
        window.location.href = "login.html";
      }
    })
    .catch(err => alert("Error: " + err));
});
        const daySelect = document.getElementById("dob-day");
        for (let d = 1; d < 32; d++) {
            const option = document.createElement("option");
            option.value = d;
            option.text = d;
            daySelect.appendChild(option);
        }

        const yearSelect = document.getElementById("dob-year");
        const currentYear = new Date().getFullYear();
        for (let y = currentYear; y >= 1900; y--) {
            const option = document.createElement("option");
            option.value = y;
            option.text = y;
            yearSelect.appendChild(option);

        }
        document.querySelector("button.btn-primary").addEventListener("click", () => {

            document.getElementById("fnameerror").innerHTML = "";
            document.getElementById("lnameerror").innerHTML = "";
            document.getElementById("dayerror").innerHTML = "";
            document.getElementById("montherror").innerHTML = "";
            document.getElementById("yearerror").innerHTML = "";
            document.getElementById("gendererror").innerHTML = "";
            document.getElementById("emailerror").innerHTML = "";
            document.getElementById("passworderror").innerHTML = "";

            const firstName = document.getElementById("firstName").value;
            const lastName = document.getElementById("lastName").value;
            const email = document.querySelector("input[type='email']").value;
            const password = document.querySelector("input[type='password']").value;

            //var FName = document.getElementById("firstName").value;
            //var LName = document.getElementById("lastName").value;
            var day = document.getElementById("dob-day").value;
            var month = document.getElementById("dob-month").value;
            var year = document.getElementById("dob-year").value;
            var gender = document.querySelector('input[name="gender"]:checked');
            //var email = document.getElementById("email").value;
            //var password = document.getElementById("pass").value;

            if (firstName == "") {
                document.getElementById("fnameerror").innerHTML = "First Name Is required";
                return false;
            }
            if (lastName == "") {
                document.getElementById("lnameerror").innerHTML = "Last Name Is required";
                return false;
            }
            if (day === "") {
                document.getElementById("dayerror").textContent = "Please select day";
                return false;
            }

            if (month === "") {
                document.getElementById("montherror").textContent = "Please select month";
                return false;
            }

            if (year === "") {
                document.getElementById("yearerror").textContent = "Please select year";
                return false;
            }
            if (day !== "" && month !== "" && year !== "") {
                let date = new Date(year, month - 1, day);
                if (date.getDate() != day || date.getMonth() != month - 1 || date.getFullYear() != year){
                    document.getElementById("dayerror").textContent = "Invalid date";
                    return false;
                }
            }
            if(!gender){
                document.getElementById("gendererror").textContent="Please select the Gender"
            }
            var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if(!emailRegex.test(email)){
                document.getElementById("emailerror").textContent="Invalid email ID";
                return false;
            }
            var passRegex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
            if(!passRegex.test(password)){
                document.getElementById("passworderror").innerHTML="<strong>Invalid password</strong> Minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character:"
                return false;
            }
debugger
            fetch("/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ firstName, lastName, email, password })
  })
    .then(async res => {
      const msg = await res.text();
      console.log("Status:", res.status);
      console.log("Message:", msg);

      if (!res.ok) {
        alert("‚ùå Error: " + msg);
        return;
      }

      alert("‚úÖ " + msg); // this shows in pop-up
      if (msg === "Registration successful") {
        window.location.href = "login.html";
      }
    })
    .catch(err => {
      alert("üåê Network error: " + err);
    });
        });

            

                 
        
        
        
        // function validation() {
            
        // }
    </script>
</body>

</html>